# FastMonitor - ç½‘ç»œæµé‡ç›‘æ§ä¸å¨èƒæ£€æµ‹å·¥å…·

## ğŸ“– é¡¹ç›®ç®€ä»‹

**FastMonitor** æ˜¯ä¸€æ¬¾åŸºäº **Wails æ¡†æ¶**å¼€å‘å¼€æºçš„**è·¨å¹³å°ç½‘ç»œæµé‡ç›‘æ§ä¸å¨èƒæ£€æµ‹å·¥å…·**,é›†æˆäº†æ•°æ®åŒ…åˆ†æã€è¿›ç¨‹å…³è”ã€ä¼šè¯æµç»Ÿè®¡ã€å¨èƒæƒ…æŠ¥æ£€æµ‹ã€åœ°ç†ä½ç½®å¯è§†åŒ–ç­‰åŠŸèƒ½äºä¸€ä½“ã€‚

- **æœ€æ–°ç‰ˆæœ¬**: 1.1.0
- **æ›´æ–°æ—¥æœŸ**: 2026/1/18
- **ä¸‹è½½åœ°å€**:  [https://github.com/vam876/FastMonitor/releases](https://github.com/vam876/FastMonitor/releases/tag/v1.1.0) (Windowsã€Apple Silicon)
- **ä½œè€…å…¶ä»–é¡¹ç›®æ¨è**:  [WEBæ—¥å¿—å¯è§†åŒ–åˆ†æå·¥å…·](https://github.com/vam876/FastWLAT)  **|**  [å›¾å½¢åŒ–Windowsæ—¥å¿—å®‰å…¨åˆ†æå·¥å…·](https://github.com/vam876/FastWinLog)  **|**  [å›¾å½¢åŒ–Linuxæ—¥å¿—å®‰å…¨åˆ†æå·¥å…·](https://github.com/vam876/FastLinLog)

### æ ¸å¿ƒç‰¹æ€§

-  **é«˜æ€§èƒ½æŠ“åŒ…å¼•æ“**: åŸºäº gopacket/pcap å®ç°,æ”¯æŒæ•°æ®åŒ…å®æ—¶å¤„ç†ï¼Œå¹¶å¯¹äº”å…ƒç»„ä¼šè¯/DNS/ICMP/HTTPè¿›è¡Œåˆ†ç±»å±•ç¤º
-  **ç²¾å‡†è¿›ç¨‹å…³è”**: è‡ªåŠ¨å°†ç½‘ç»œæµé‡ä¸è¿›ç¨‹ç»‘å®š,æ”¯æŒä¸»æµæ“ä½œç³»ç»Ÿ
-  **æ™ºèƒ½å¨èƒæ£€æµ‹**: æ”¯æŒè‡ªå®šä¹‰ç—…æ¯’ç­‰å¨èƒæƒ…æŠ¥IOCè§„åˆ™,å®æ—¶å‘Šè­¦
-  **3Dåœ°ç†å¯è§†åŒ–**: åŸºäº ECharts GL çš„3Dåœ°çƒå’Œ2Dåœ°å›¾æµé‡å±•ç¤º
-  **å®æ—¶ä»ªè¡¨ç›˜**: å¤§å±å±•ç¤ºç½‘ç»œæµé‡ã€åè®®åˆ†å¸ƒã€TOPæ’è¡Œ
-  **æ•°æ®æŒä¹…åŒ–**: SQLiteå­˜å‚¨ + PCAPæ–‡ä»¶å½’æ¡£,æ”¯æŒå†å²å›æº¯
-  **ç°ä»£åŒ–ç•Œé¢**: Vue 3 + Element Plus + æµ…è‰²/æ·±è‰²ä¸»é¢˜


<img width="1506" height="891" alt="æˆªå±2025-10-08 14 11 25" src="https://github.com/user-attachments/assets/6bd2f3ef-cd7b-40df-a03c-c9d4cbc62652" />

-  **ä¸Šå›¾ï¼šå¯è§†åŒ–ä»ªè¡¨ç›˜ï¼Œç½‘ç»œæ•°æ®ä¸€ç›®äº†ç„¶**

<img width="1384" height="861" alt="image" src="https://github.com/user-attachments/assets/2d475dbe-60b7-4e3c-acec-b220b0e28691" />

-  **ä¸Šå›¾ï¼šç³»ç»Ÿç½‘ç»œä¼šè¯ç›‘å¬ï¼Œæ”¯æŒè¿›ç¨‹å…³è”**
<img width="1384" height="861" alt="image" src="https://github.com/user-attachments/assets/e0e8fece-8818-40cf-9a73-c680d244fd3f" />

-  **ä¸Šå›¾ï¼šç½‘ç»œæµé‡ç›‘æ§ï¼Œæ•°æ®å¤–å‘åŠæ—¶å‘ç°**
  
<img width="1507" height="775" alt="æˆªå±2025-10-08 14 10 46" src="https://github.com/user-attachments/assets/060488a4-f12a-4a78-933d-eafd9992ff5f" />

-  **ä¸Šå›¾ï¼šå¯¹å½“å‰è®¡ç®—æœºè¿›è¡Œæµé‡è¿›ç¨‹ç›‘å¬ï¼Œæ”¯æŒç›‘å¬ç³»ç»Ÿè¿›ç¨‹ã€DNSè¯·æ±‚ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼Œå®ç°å®‰å…¨æ€åŠ¿æ„ŸçŸ¥**

 <img width="1506" height="891" alt="æˆªå±2025-10-08 14 11 03" src="https://github.com/user-attachments/assets/bf6f6a38-e3b2-409d-b3d5-cd69eb7dfe81" />
 
-  **ä¸Šå›¾ï¼šå°†å½“å‰è®¡ç®—æœºçš„æ‰€æœ‰ç½‘ç»œè®¿é—®è¿›è¡Œå¯è§†åŒ–ï¼Œæ¸²æŸ“åˆ°åœ°å›¾ç»„ä»¶ï¼Œæ”¯æŒä¸–ç•Œåœ°å›¾å’Œä¸­åœ°å›¾**


<img width="1920" height="1017" alt="æˆªå›¾_20251009092433" src="https://github.com/user-attachments/assets/14bddfef-e27b-4802-89a3-13dd2de22429" />


-  **ä¸Šå›¾ï¼šå°†å½“å‰è®¡ç®—æœºçš„æ‰€æœ‰ç½‘ç»œè®¿é—®è¿›è¡Œå¯è§†åŒ–ï¼Œå°†æ•°æ®æ¸²æŸ“å3D åœ°çƒ å®ç°æœ¬ç½‘ç»œè®¿é—®å¯è§†åŒ–åˆ†æ**

---

##  ä¸»è¦ç”¨é€”

| åº”ç”¨åœºæ™¯ | åŠŸèƒ½æè¿° |
|---------|---------|
| **ç½‘ç»œç›‘æ§** | å®æ—¶ç›‘æ§å†…ç½‘æµé‡,å‘ç°å¼‚å¸¸å¤–è”å’Œæ•°æ®æ³„éœ² |
| **å®‰å…¨å¨èƒåˆ†æ** | æ£€æµ‹C2é€šä¿¡ã€é’“é±¼æ”»å‡»ã€æ¶æ„è½¯ä»¶è¡Œä¸º |
| **æµé‡å®¡è®¡** | è®°å½•æ‰€æœ‰ç½‘ç»œæ´»åŠ¨,æ”¯æŒå–è¯å’Œåˆè§„å®¡è®¡ |
| **æ€§èƒ½è¯Šæ–­** | åˆ†æç½‘ç»œç“¶é¢ˆã€å¼‚å¸¸æµé‡ã€åè®®åˆ†å¸ƒ |
| **å¼€å‘è°ƒè¯•** | æŠ“åŒ…åˆ†æHTTP/DNS/ICMPç­‰åè®®ç»†èŠ‚ |
| **å®‰å…¨ç ”ç©¶** | æ¶æ„æ ·æœ¬è¡Œä¸ºåˆ†æã€IOCæå– |

---

##  ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FastMonitor å‰ç«¯                       â”‚
â”‚          Vue 3 + TypeScript + Element Plus                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ä»ªè¡¨ç›˜    â”‚æ•°æ®åŒ…     â”‚ä¼šè¯æµ     â”‚è¿›ç¨‹      â”‚å‘Šè­¦       â”‚   â”‚
â”‚  â”‚2D/3Dåœ°å›¾ â”‚DNS/HTTP  â”‚ç»Ÿè®¡       â”‚å…³è”      â”‚è§„åˆ™       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚          â”‚          â”‚          â”‚          â”‚
        â”‚      Wails RPC (JSON)                    â”‚
        â”‚          â”‚          â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â–¼          â–¼          â–¼          â–¼          â–¼         â”‚
â”‚                  FastMonitor åç«¯ (Go)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚æŠ“åŒ…å¼•æ“  â”‚åè®®è§£æ   â”‚è¿›ç¨‹æ˜ å°„   â”‚å‘Šè­¦å¼•æ“   â”‚å­˜å‚¨å±‚    â”‚   â”‚
â”‚  â”‚gopacket  â”‚Parser    â”‚Process   â”‚Alert     â”‚SQLite    â”‚   â”‚
â”‚  â”‚          â”‚          â”‚Mapper    â”‚Engine    â”‚PCAP      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚          â”‚          â”‚          â”‚          â”‚         â”‚
â”‚       â–¼          â–¼          â–¼          â–¼          â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚        ç½‘ç»œæ¥å£å±‚ (NIC Capture)                      â”‚    â”‚
â”‚  â”‚   Ethernet / Wi-Fi / VPN / Loopback                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

##  åŠŸèƒ½æ¨¡å—è¯¦è§£

###  ç½‘å¡é€‰æ‹© (Network Interface Selection)

#### åŠŸèƒ½æè¿°
- è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿæ‰€æœ‰å¯ç”¨ç½‘ç»œæ¥å£(ç½‘å¡)
- æ”¯æŒç‰©ç†ç½‘å¡ã€è™šæ‹Ÿç½‘å¡ã€å›ç¯æ¥å£ã€VPNéš§é“
- å®æ—¶æ˜¾ç¤ºç½‘å¡çŠ¶æ€å’Œæµé‡ç»Ÿè®¡

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **ç½‘å¡åˆ—è¡¨** | æ˜¾ç¤ºæ‰€æœ‰æ¥å£åç§°ã€IPåœ°å€ã€MACåœ°å€ã€çŠ¶æ€ |
| **ç½‘å¡ç­›é€‰** | æ”¯æŒæŒ‰æ¥å£ç±»å‹(æœ‰çº¿/æ— çº¿/è™šæ‹Ÿ)ç­›é€‰ |
| **å®æ—¶çŠ¶æ€** | æ˜¾ç¤ºæ¥å£æ˜¯å¦æ¿€æ´»ã€å½“å‰æµé‡é€Ÿç‡ |
| **å¿«é€Ÿåˆ‡æ¢** | ä¸€é”®åˆ‡æ¢æŠ“åŒ…ç½‘å¡,æ— éœ€é‡å¯ |
| **æƒé™æ£€æµ‹** | è‡ªåŠ¨æ£€æµ‹æŠ“åŒ…æƒé™,æç¤ºç®¡ç†å‘˜æƒé™ |

#### æŠ€æœ¯å®ç°
```go
// ç½‘å¡æšä¸¾ (internal/capture/capture.go)
func ListInterfaces() ([]*NetworkInterface, error) {
    devices, _ := pcap.FindAllDevs()
    for _, device := range devices {
        // è§£æIPã€MACã€MTUç­‰ä¿¡æ¯
        // æ£€æµ‹ç½‘å¡çŠ¶æ€å’Œç±»å‹
    }
}
```

#### ä½¿ç”¨è¯´æ˜
1. **å¯åŠ¨åº”ç”¨** â†’ ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ "è®¾ç½®"æŒ‰é’®
2. **ç½‘å¡åˆ—è¡¨** â†’ æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨ç½‘å¡åŠå…¶è¯¦ç»†ä¿¡æ¯
3. **é€‰æ‹©ç½‘å¡** â†’ ç‚¹å‡»ç›®æ ‡ç½‘å¡,ç³»ç»Ÿè‡ªåŠ¨åˆ‡æ¢æŠ“åŒ…æ¥å£
4. **å¼€å§‹æŠ“åŒ…** â†’ ç‚¹å‡»"å¼€å§‹æ•è·"æŒ‰é’®å¼€å§‹ç›‘æ§

#### å¸¸è§é—®é¢˜
- âŒ **æ— ç½‘å¡æ˜¾ç¤º**: éœ€è¦ä»¥ç®¡ç†å‘˜/rootæƒé™è¿è¡Œï¼Œéœ€å®‰è£…Npcap (https://npcap.com/)
- âŒ **æŠ“åŒ…å¤±è´¥**: æ£€æŸ¥WinPcap/Npcap(Windows)æˆ–libpcap(Linux/macOS)æ˜¯å¦å®‰è£…
- âœ… **æ¨èç½‘å¡**: é€‰æ‹©æ´»è·ƒæµé‡çš„ç‰©ç†ç½‘å¡,é¿å…é€‰æ‹©å›ç¯æ¥å£

---

### 2ï¸âƒ£ ä»ªè¡¨ç›˜ (Dashboard)

#### åŠŸèƒ½æè¿°
æä¾›å®æ—¶ç½‘ç»œæµé‡ç›‘æ§çš„å¤§å±å±•ç¤º,åŒ…æ‹¬ç»Ÿè®¡å›¾è¡¨ã€TOPæ’è¡Œã€åè®®åˆ†å¸ƒç­‰å¯è§†åŒ–ç»„ä»¶ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| æ¨¡å— | è¯´æ˜ |
|-----|------|
| **å®æ—¶æµé‡æ›²çº¿** | æ˜¾ç¤ºä¸Šä¸‹è¡Œæµé‡çš„æ—¶é—´è¶‹åŠ¿(bps/pps) |
| **åè®®åˆ†å¸ƒé¥¼å›¾** | TCP/UDP/ICMP/DNS/HTTPç­‰åè®®å æ¯” |
| **TOPæºåœ°å€** | æµé‡æœ€å¤§çš„å‰10ä¸ªæºIP |
| **TOPç›®æ ‡åœ°å€** | æµé‡æœ€å¤§çš„å‰10ä¸ªç›®æ ‡IP |
| **TOPè¿›ç¨‹æ’è¡Œ** | ç½‘ç»œæ´»åŠ¨æœ€é¢‘ç¹çš„å‰10ä¸ªè¿›ç¨‹ |
| **åœ°ç†åˆ†å¸ƒçƒ­åŠ›** | è¿æ¥å›½å®¶/åœ°åŒºçš„çƒ­åŠ›åœ°å›¾ |
| **å‘Šè­¦ç»Ÿè®¡** | å®æ—¶æ˜¾ç¤ºCritical/Warning/Infoå‘Šè­¦æ•°é‡ |

#### å¯è§†åŒ–ç»„ä»¶
```typescript
// æµé‡è¶‹åŠ¿å›¾ (EChartsæŠ˜çº¿å›¾)
{
  xAxis: { data: timestamps },     // æ—¶é—´è½´
  series: [
    { name: 'ä¸Šè¡Œæµé‡', data: txBytes },
    { name: 'ä¸‹è¡Œæµé‡', data: rxBytes }
  ]
}

// åè®®åˆ†å¸ƒå›¾ (EChartsé¥¼å›¾)
{
  series: [{
    type: 'pie',
    data: [
      { name: 'TCP', value: 45.2 },
      { name: 'UDP', value: 30.1 },
      { name: 'ICMP', value: 5.3 }
    ]
  }]
}
```

#### æ•°æ®åˆ·æ–°
- **é»˜è®¤åˆ·æ–°é—´éš”**: 2ç§’
- **æ•°æ®çª—å£**: æœ€è¿‘60ç§’/5åˆ†é’Ÿ/1å°æ—¶å¯é€‰
- **è‡ªé€‚åº”æ€§èƒ½**: æµé‡è¿‡å¤§æ—¶è‡ªåŠ¨é™ä½åˆ·æ–°ç‡

#### å¤§å±æ¨¡å¼
- **è§¦å‘æ–¹å¼**: ç‚¹å‡»ä»ªè¡¨ç›˜å³ä¸Šè§’"å…¨å±"æŒ‰é’®
- **å¸ƒå±€é£æ ¼**: æ·±è‰²ä¸»é¢˜ + èµ›åšæœ‹å…‹é£æ ¼è¾¹æ¡†
- **ç‰¹æ®Šæ•ˆæœ**: æ•°å­—æ»šåŠ¨åŠ¨ç”»ã€å›¾è¡¨è‡ªé€‚åº”ç¼©æ”¾
- **é€€å‡ºæ–¹å¼**: æŒ‰ESCé”®æˆ–ç‚¹å‡»å³ä¸Šè§’é€€å‡ºæŒ‰é’®

---

### 3ï¸âƒ£ æ•°æ®åŒ… (Packet Capture)

#### åŠŸèƒ½æè¿°
å®æ—¶æ•è·å¹¶è§£æç½‘ç»œæ•°æ®åŒ…,æ”¯æŒå¤šå±‚åè®®åˆ†æå’Œæ•°æ®åŒ…è¿‡æ»¤ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **å®æ—¶æŠ“åŒ…** | æ¯ç§’æ•è·æ•°åƒä¸ªæ•°æ®åŒ…å¹¶è§£ç  |
| **å¤šå±‚è§£æ** | è§£æEthernet â†’ IP â†’ TCP/UDP â†’ HTTP/DNS |
| **å­—æ®µæå–** | è‡ªåŠ¨æå–æº/ç›®æ ‡IPã€ç«¯å£ã€åè®®ã€è½½è· |
| **BPFè¿‡æ»¤å™¨** | æ”¯æŒBerkeley Packet Filterè¯­æ³• |
| **æ•°æ®åŒ…è¯¦æƒ…** | æ˜¾ç¤ºåŸå§‹åå…­è¿›åˆ¶å’ŒASCIIè½½è· |
| **å¯¼å‡ºåŠŸèƒ½** | å¯¼å‡ºä¸ºPCAPæ ¼å¼ä¾›Wiresharkåˆ†æ |

#### æ•°æ®åŒ…å­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `timestamp` | æ•è·æ—¶é—´(çº³ç§’ç²¾åº¦) | 2025-10-08 14:32:15.123456 |
| `src_ip` | æºIPåœ°å€ | 192.168.1.100 |
| `dst_ip` | ç›®æ ‡IPåœ°å€ | 8.8.8.8 |
| `src_port` | æºç«¯å£ | 51234 |
| `dst_port` | ç›®æ ‡ç«¯å£ | 443 |
| `protocol` | ä¼ è¾“å±‚åè®® | TCP / UDP / ICMP |
| `length` | æ•°æ®åŒ…é•¿åº¦(å­—èŠ‚) | 1420 |
| `payload` | åº”ç”¨å±‚è½½è·(Base64ç¼–ç ) | SGVsbG8gV29ybGQ= |
| `process_name` | å…³è”è¿›ç¨‹å(å¦‚æœæˆåŠŸæ˜ å°„) | chrome.exe |

#### BPFè¿‡æ»¤å™¨ç¤ºä¾‹
```bash
# åªæ•è·HTTPæµé‡
tcp port 80 or tcp port 8080

# åªæ•è·DNSæŸ¥è¯¢
udp port 53

# åªæ•è·ç‰¹å®šIPçš„æµé‡
host 192.168.1.100

# åªæ•è·å‡ºç«™æµé‡
src net 192.168.0.0/16

# ç»„åˆæ¡ä»¶
tcp and dst port 443 and not host 127.0.0.1
```

#### æŠ€æœ¯å®ç°
```go
// æ•°æ®åŒ…æ•è·ä¸»å¾ªç¯ (internal/capture/capture.go)
func (c *Capture) Start() {
    handle, _ := pcap.OpenLive(c.device, snapLen, promiscuous, timeout)
    packetSource := gopacket.NewPacketSource(handle, handle.LinkType())
    
    for packet := range packetSource.Packets() {
        // è§£æEthernetå±‚
        ethLayer := packet.Layer(layers.LayerTypeEthernet)
        
        // è§£æIPå±‚
        ipLayer := packet.Layer(layers.LayerTypeIPv4)
        
        // è§£æTCP/UDPå±‚
        tcpLayer := packet.Layer(layers.LayerTypeTCP)
        
        // æå–è½½è·
        payload := packet.ApplicationLayer().Payload()
        
        // å‘é€åˆ°å¤„ç†ç®¡é“
        c.packetChan <- parsedPacket
    }
}
```

#### æ€§èƒ½ä¼˜åŒ–
- **é›¶æ‹·è´**: ä½¿ç”¨ `gopacket.NoCopy` é¿å…å†…å­˜å¤åˆ¶
- **æ‰¹é‡å¤„ç†**: 100ä¸ªæ•°æ®åŒ…æ‰¹é‡å…¥åº“
- **ç¯å½¢ç¼“å†²**: å†…å­˜é™åˆ¶æ—¶ä¸¢å¼ƒæ—§æ•°æ®åŒ…
- **å¼‚æ­¥å†™å…¥**: æŠ“åŒ…çº¿ç¨‹å’Œå­˜å‚¨çº¿ç¨‹åˆ†ç¦»

---

### 4ï¸âƒ£ DNSè§£æ (DNS Queries)

#### åŠŸèƒ½æè¿°
ä¸“é—¨æ•è·å¹¶åˆ†æDNSæŸ¥è¯¢å’Œå“åº”,æ£€æµ‹æ¶æ„åŸŸåå’ŒDNSéš§é“ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **DNSè®°å½•è§£æ** | è§£æA/AAAA/CNAME/MX/TXTç­‰è®°å½•ç±»å‹ |
| **æŸ¥è¯¢ç»Ÿè®¡** | ç»Ÿè®¡æœ€é¢‘ç¹æŸ¥è¯¢çš„åŸŸåTOP10 |
| **å“åº”æ—¶é—´** | è®°å½•DNSæœåŠ¡å™¨å“åº”å»¶è¿Ÿ |
| **å¤±è´¥æŸ¥è¯¢** | è®°å½•NXDOMAINå’ŒSERVFAILå“åº” |
| **æ¶æ„åŸŸåæ£€æµ‹** | åŒ¹é…å¨èƒæƒ…æŠ¥ä¸­çš„C2åŸŸå |

#### DNSå­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `query_name` | æŸ¥è¯¢åŸŸå | www.example.com |
| `query_type` | è®°å½•ç±»å‹ | A / AAAA / CNAME |
| `response_code` | å“åº”ç  | NOERROR / NXDOMAIN |
| `answers` | è§£æç»“æœ(JSONæ•°ç»„) | ["93.184.216.34"] |
| `dns_server` | DNSæœåŠ¡å™¨IP | 8.8.8.8 |
| `latency_ms` | å“åº”æ—¶é—´(æ¯«ç§’) | 23 |

#### å¨èƒæ£€æµ‹è§„åˆ™
```go
// DNSè§„åˆ™åŒ¹é… (å†…ç½®é“¶ç‹C2åŸŸå)
rule := &AlertRule{
    Name:              "é“¶ç‹ç—…æ¯’ - C2åŸŸåæ£€æµ‹",
    RuleType:          "dns",
    ConditionField:    "domain",
    ConditionOperator: "contains",
    ConditionValue:    "12-18.qq-weixin.org,8004.twilight.zip,addr.ktsr.cc",
    AlertLevel:        "critical",
}

// åŒ¹é…é€»è¾‘
func matchDNSRule(queryName string, rule *AlertRule) bool {
    domains := strings.Split(rule.ConditionValue, ",")
    for _, domain := range domains {
        if strings.Contains(queryName, domain) {
            return true  // è§¦å‘å‘Šè­¦!
        }
    }
    return false
}
```

#### ä½¿ç”¨åœºæ™¯
-  **æ¶æ„è½¯ä»¶å¤–è”**: æ£€æµ‹DGAåŸŸåã€C2åŸŸå
-  **é’“é±¼æ”»å‡»**: è¯†åˆ«ä¼ªè£…æˆé“¶è¡Œ/æ”¿åºœçš„é’“é±¼åŸŸå
-  **æµé‡åˆ†æ**: ç»Ÿè®¡å‘˜å·¥è®¿é—®æœ€å¤šçš„ç½‘ç«™
-  **DNSåŠ«æŒ**: æ£€æµ‹å¼‚å¸¸çš„DNSå“åº”(å¦‚è¿”å›é”™è¯¯IP)

---

### 5ï¸âƒ£ HTTPæµé‡ (HTTP Requests)

#### åŠŸèƒ½æè¿°
æ•è·å¹¶åˆ†æHTTP/HTTPSæµé‡,æå–URLã€User-Agentã€çŠ¶æ€ç ç­‰å…³é”®ä¿¡æ¯ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **HTTPè¯·æ±‚è§£æ** | æå–Method/URL/Headers/Body |
| **HTTPå“åº”è§£æ** | æå–Status Code/Content-Type/Length |
| **HTTPSå…ƒæ•°æ®** | å³ä½¿ä¸è§£å¯†ä¹Ÿèƒ½æå–SNIåŸŸå |
| **æ¶æ„URLæ£€æµ‹** | åŒ¹é…é’“é±¼URLå’Œæ¶æ„ä¸‹è½½é“¾æ¥ |
| **User-Agentåˆ†æ** | è¯†åˆ«æµè§ˆå™¨/çˆ¬è™«/æ¶æ„è½¯ä»¶UA |

#### HTTPå­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `method` | HTTPæ–¹æ³• | GET / POST / PUT |
| `url` | å®Œæ•´URL | https://example.com/api/data |
| `host` | ç›®æ ‡ä¸»æœºå | example.com |
| `user_agent` | å®¢æˆ·ç«¯æ ‡è¯† | Mozilla/5.0 ... |
| `status_code` | å“åº”çŠ¶æ€ç  | 200 / 404 / 500 |
| `content_type` | å†…å®¹ç±»å‹ | application/json |
| `content_length` | å“åº”å¤§å°(å­—èŠ‚) | 4096 |

#### å¨èƒæ£€æµ‹è§„åˆ™
```go
// HTTPè§„åˆ™ - æ£€æµ‹æ¶æ„PNGä¸‹è½½
rule := &AlertRule{
    Name:              "é“¶ç‹ç—…æ¯’ - æ¶æ„PNGä¸‹è½½æ£€æµ‹",
    RuleType:          "http",
    ConditionField:    "url",
    ConditionOperator: "regex",
    ConditionValue:    "(?i)183\\.167\\.230\\.197:18743/(0CFA042F|5B16AF14|57BC9B7E|test)\\.Png",
    AlertLevel:        "critical",
}

// HTTPè§„åˆ™ - æ£€æµ‹é’“é±¼URL
rule := &AlertRule{
    Name:              "é“¶ç‹ç—…æ¯’ - é’“é±¼URLæ£€æµ‹",
    RuleType:          "http",
    ConditionField:    "url",
    ConditionOperator: "contains",
    ConditionValue:    "cuomicufvhehy.cn",
    AlertLevel:        "critical",
}
```

#### HTTPSæµé‡å¤„ç†
âš ï¸ **æ³¨æ„**: FastMonitor **ä¸è§£å¯†HTTPSæµé‡**(æ— ä¸­é—´äººæ”»å‡»),ä½†ä»å¯æå–:
- **SNI(Server Name Indication)**: TLSæ¡æ‰‹æ—¶çš„æ˜æ–‡åŸŸå
- **è¯ä¹¦ä¿¡æ¯**: æœåŠ¡å™¨è¯ä¹¦çš„é¢å‘è€…å’Œæœ‰æ•ˆæœŸ
- **æµé‡ç»Ÿè®¡**: ä¸Šä¸‹è¡Œå­—èŠ‚æ•°å’Œæ•°æ®åŒ…æ•°é‡

---

### 6ï¸âƒ£ ICMPæµé‡ (ICMP Packets)

#### åŠŸèƒ½æè¿°
æ•è·å¹¶åˆ†æICMPæ•°æ®åŒ…,åŒ…æ‹¬pingè¯·æ±‚ã€tracerouteã€ç½‘ç»œä¸å¯è¾¾ç­‰æ¶ˆæ¯ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **ICMPç±»å‹è¯†åˆ«** | Echo Request/Replyã€Destination Unreachable |
| **Pingç»Ÿè®¡** | å¾€è¿”æ—¶å»¶(RTT)ã€ä¸¢åŒ…ç‡ |
| **ç½‘ç»œè¯Šæ–­** | è¯†åˆ«è·¯ç”±é—®é¢˜ã€MTUé—®é¢˜ |
| **å¼‚å¸¸æ£€æµ‹** | æ£€æµ‹ICMP Floodæ”»å‡»ã€ICMPéš§é“ |

#### ICMPå­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `type` | ICMPç±»å‹ | 8(Echo Request) / 0(Echo Reply) |
| `code` | ICMPä»£ç  | 0(ç½‘ç»œä¸å¯è¾¾) / 1(ä¸»æœºä¸å¯è¾¾) |
| `sequence` | åºåˆ—å· | 12345 |
| `identifier` | æ ‡è¯†ç¬¦ | 54321 |
| `rtt_ms` | å¾€è¿”æ—¶å»¶(æ¯«ç§’) | 15.2 |

#### å¸¸è§ICMPç±»å‹
| Type | Code | è¯´æ˜ |
|------|------|------|
| 0 | 0 | Echo Reply (Pingå“åº”) |
| 3 | 0-15 | Destination Unreachable (ç›®æ ‡ä¸å¯è¾¾) |
| 8 | 0 | Echo Request (Pingè¯·æ±‚) |
| 11 | 0-1 | Time Exceeded (TTLè¶…æ—¶,traceroute) |

---

### 7ï¸âƒ£ ä¼šè¯æµç»Ÿè®¡ (Session Flow Statistics)

#### åŠŸèƒ½æè¿°
å°†é›¶æ•£çš„æ•°æ®åŒ…èšåˆä¸ºä¼šè¯æµ(Session),ç»Ÿè®¡æ¯ä¸ªä¼šè¯çš„æµé‡ã€æ—¶å»¶ã€æ•°æ®åŒ…æ•°ç­‰æŒ‡æ ‡ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **äº”å…ƒç»„èšåˆ** | æŒ‰(SrcIP, DstIP, SrcPort, DstPort, Protocol)èšåˆ |
| **åŒå‘æµé‡ç»Ÿè®¡** | åˆ†åˆ«ç»Ÿè®¡ä¸Šä¸‹è¡Œå­—èŠ‚æ•°å’Œæ•°æ®åŒ…æ•° |
| **ä¼šè¯æ—¶é•¿** | è®°å½•ä¼šè¯å¼€å§‹æ—¶é—´å’ŒæŒç»­æ—¶é•¿ |
| **åœ°ç†ä½ç½®** | è‡ªåŠ¨æŸ¥è¯¢ç›®æ ‡IPçš„å›½å®¶/åŸå¸‚ |
| **è¿›ç¨‹ç»‘å®š** | è‡ªåŠ¨å…³è”å‘èµ·è¯¥ä¼šè¯çš„è¿›ç¨‹ |
| **çŠ¶æ€è¿½è¸ª** | è¯†åˆ«TCPè¿æ¥çŠ¶æ€(SYN/ACK/FIN/RST) |

#### ä¼šè¯å­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `session_key` | ä¼šè¯å”¯ä¸€æ ‡è¯†(å“ˆå¸Œ) | a3f8c2d1... |
| `src_ip` | æºIP | 192.168.1.100 |
| `dst_ip` | ç›®æ ‡IP | 93.184.216.34 |
| `src_port` | æºç«¯å£ | 51234 |
| `dst_port` | ç›®æ ‡ç«¯å£ | 443 |
| `protocol` | åè®® | TCP |
| `tx_bytes` | ä¸Šè¡Œå­—èŠ‚æ•° | 1024000 |
| `rx_bytes` | ä¸‹è¡Œå­—èŠ‚æ•° | 5120000 |
| `tx_packets` | ä¸Šè¡Œæ•°æ®åŒ…æ•° | 1500 |
| `rx_packets` | ä¸‹è¡Œæ•°æ®åŒ…æ•° | 3800 |
| `start_time` | ä¼šè¯å¼€å§‹æ—¶é—´ | 2025-10-08 14:32:15 |
| `duration_sec` | ä¼šè¯æŒç»­æ—¶é•¿(ç§’) | 125.3 |
| `dst_country` | ç›®æ ‡å›½å®¶ | United States |
| `dst_city` | ç›®æ ‡åŸå¸‚ | Ashburn |
| `process_name` | å…³è”è¿›ç¨‹ | chrome.exe |

#### ä¼šè¯èšåˆé€»è¾‘
```go
// ä¼šè¯Keyè®¡ç®— (åŒå‘å¯¹ç§°å“ˆå¸Œ)
func sessionKey(srcIP, dstIP string, srcPort, dstPort uint16, proto string) string {
    // ç¡®ä¿åŒå‘æµé‡ä½¿ç”¨ç›¸åŒKey
    if srcIP > dstIP || (srcIP == dstIP && srcPort > dstPort) {
        srcIP, dstIP = dstIP, srcIP
        srcPort, dstPort = dstPort, srcPort
    }
    return fmt.Sprintf("%s:%d-%s:%d-%s", srcIP, srcPort, dstIP, dstPort, proto)
}

// ä¼šè¯æ›´æ–°
func updateSession(packet *Packet) {
    key := sessionKey(packet.SrcIP, packet.DstIP, ...)
    session := sessions[key]
    
    // æ›´æ–°ç»Ÿè®¡
    if packet.SrcIP == session.SrcIP {
        session.TxBytes += packet.Length
        session.TxPackets++
    } else {
        session.RxBytes += packet.Length
        session.RxPackets++
    }
    
    session.LastSeen = time.Now()
}
```

#### ä½¿ç”¨åœºæ™¯
- ğŸ“Š **æµé‡å®¡è®¡**: æŸ¥çœ‹æŸIPçš„æ‰€æœ‰å¤–è”ä¼šè¯
- ğŸ” **å¼‚å¸¸æ£€æµ‹**: å‘ç°æµé‡å¼‚å¸¸å¤§çš„ä¼šè¯(å¦‚æ•°æ®å¤–æ³„)
- ğŸŒ **åœ°ç†åˆ†æ**: ç»Ÿè®¡è¿æ¥æœ€å¤šçš„å›½å®¶/åœ°åŒº
- ğŸš« **é»‘åå•æ‹¦æˆª**: é˜»æ–­è¿æ¥åˆ°æ¶æ„IPçš„ä¼šè¯

---

### 8ï¸âƒ£ è¿›ç¨‹å…³è” (Process Mapping)

#### åŠŸèƒ½æè¿°
è‡ªåŠ¨å°†ç½‘ç»œæµé‡ä¸å‘èµ·è¯¥æµé‡çš„è¿›ç¨‹ç»‘å®š,å®ç°è¿›ç¨‹çº§ç½‘ç»œç›‘æ§ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **è¿›ç¨‹æšä¸¾** | éå†ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹åŠå…¶ç½‘ç»œè¿æ¥ |
| **è¿æ¥æ˜ å°„** | å°†(IP, Port)æ˜ å°„åˆ°è¿›ç¨‹PID |
| **è¿›ç¨‹ä¿¡æ¯** | æå–è¿›ç¨‹åã€è·¯å¾„ã€å‘½ä»¤è¡Œã€å¯åŠ¨æ—¶é—´ |
| **è¿›ç¨‹ç»Ÿè®¡** | ç»Ÿè®¡æ¯ä¸ªè¿›ç¨‹çš„ç½‘ç»œæµé‡å’Œè¿æ¥æ•° |
| **è¿›ç¨‹å‘Šè­¦** | æ£€æµ‹æ¶æ„è¿›ç¨‹çš„ç½‘ç»œè¡Œä¸º |

#### è¿›ç¨‹å­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `pid` | è¿›ç¨‹ID | 1234 |
| `name` | è¿›ç¨‹å | chrome.exe |
| `path` | å®Œæ•´è·¯å¾„ | C:\Program Files\Google\Chrome\chrome.exe |
| `cmdline` | å‘½ä»¤è¡Œå‚æ•° | --type=renderer --lang=zh-CN |
| `connections` | æ´»è·ƒè¿æ¥æ•° | 15 |
| `tx_bytes` | è¿›ç¨‹ä¸Šä¼ æ€»é‡ | 10240000 |
| `rx_bytes` | è¿›ç¨‹ä¸‹è½½æ€»é‡ | 51200000 |
| `start_time` | è¿›ç¨‹å¯åŠ¨æ—¶é—´ | 2025-10-08 14:00:00 |

#### æŠ€æœ¯å®ç°
```go
// Windowsè¿›ç¨‹æ˜ å°„ (internal/process/mapper.go)
func GetProcessByConnection(localIP string, localPort uint16) (*Process, error) {
    // æ–¹æ³•1: GetExtendedTcpTable (Windows)
    table, _ := GetExtendedTcpTable()
    for _, row := range table {
        if row.LocalAddr == localIP && row.LocalPort == localPort {
            return GetProcessByPID(row.OwningPid)
        }
    }
    
    // æ–¹æ³•2: /proc/net/tcp (Linux)
    f, _ := os.Open("/proc/net/tcp")
    scanner := bufio.NewScanner(f)
    for scanner.Scan() {
        // è§£æ/proc/net/tcpæ ¼å¼,æå–inode
        // éå†/proc/[pid]/fdæ‰¾åˆ°åŒ¹é…inodeçš„è¿›ç¨‹
    }
}
```

#### å¨èƒæ£€æµ‹è§„åˆ™
```go
// è¿›ç¨‹è§„åˆ™ - æ£€æµ‹æ¶æ„è¿›ç¨‹
rule := &AlertRule{
    Name:              "é“¶ç‹ç—…æ¯’ - å·²çŸ¥æ¶æ„è¿›ç¨‹æ£€æµ‹",
    RuleType:          "process",
    ConditionField:    "process_name",
    ConditionOperator: "regex",
    ConditionValue:    "(?i)(Ubit\\.exe|DUbit\\.exe|ggaa\\.exe|wrdlv4\\.exe|GDFInstall\\.exe|dzfp\\.exe|ChromeGPT_install\\.exe)",
    AlertLevel:        "critical",
}

```

---

### 9ï¸âƒ£ å‘Šè­¦ç³»ç»Ÿ (Alert System)

#### åŠŸèƒ½æè¿°
åŸºäºå¨èƒæƒ…æŠ¥IOCè§„åˆ™,å®æ—¶æ£€æµ‹æ¶æ„æµé‡å¹¶ç”Ÿæˆå‘Šè­¦ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **è§„åˆ™å¼•æ“** | æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€å…³é”®è¯åŒ¹é… |
| **å¤šçº§å‘Šè­¦** | Critical / Error / Warning / Info |
| **å‘Šè­¦èšåˆ** | ç›¸åŒç‰¹å¾çš„å‘Šè­¦è‡ªåŠ¨åˆå¹¶è®¡æ•° |
| **å‘Šè­¦ç¡®è®¤** | æ”¯æŒæ‰‹åŠ¨ç¡®è®¤å’Œæ‰¹é‡ç¡®è®¤ |
| **å‘Šè­¦å¯¼å‡º** | å¯¼å‡ºä¸ºJSON/CSVä¾›SIEMåˆ†æ |
| **å†…ç½®è§„åˆ™** | é¢„ç½®éƒ¨åˆ†é“¶ç‹ç—…æ¯’ç­‰å¨èƒçš„IOCè§„åˆ™ç¤ºä¾‹ |

#### å‘Šè­¦è§„åˆ™å­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `name` | è§„åˆ™åç§° | é“¶ç‹ç—…æ¯’ - C2åŸŸåæ£€æµ‹ |
| `rule_type` | è§„åˆ™ç±»å‹ | dns / http / process / dst_ip |
| `condition_field` | åŒ¹é…å­—æ®µ | domain / url / process_name / dst_ip |
| `condition_operator` | åŒ¹é…æ“ä½œç¬¦ | contains / regex / equals |
| `condition_value` | åŒ¹é…å€¼ | 12-18.qq-weixin.org,addr.ktsr.cc |
| `alert_level` | å‘Šè­¦çº§åˆ« | critical / warning / info |
| `description` | è§„åˆ™æè¿° | æ£€æµ‹é“¶ç‹ç—…æ¯’å·²çŸ¥C2åŸŸå(2025å¹´æ´»è·ƒ) |
| `enabled` | æ˜¯å¦å¯ç”¨ | true / false |

#### å†…ç½®å¨èƒæ£€æµ‹è§„åˆ™

ç³»ç»Ÿé¢„ç½®äº†**5æ¡ç¤ºä¾‹è§„åˆ™**,é’ˆå¯¹**é“¶ç‹ç—…æ¯’(SilverFox)**ç­‰APTå¨èƒ:

**1. é“¶ç‹ç—…æ¯’ - å·²çŸ¥æ¶æ„è¿›ç¨‹æ£€æµ‹** (Critical)
- ç±»å‹: `process` 
- ç‰¹å¾: `Ubit.exe`, `DUbit.exe`, `ggaa.exe`, `wrdlv4.exe`, `GDFInstall.exe`, `dzfp.exe`, `ChromeGPT_install.exe`
- è¯´æ˜: æ£€æµ‹7ä¸ªå·²çŸ¥æ¶æ„è¿›ç¨‹,åŒ…æ‹¬è¿›ç¨‹æ³¨å…¥ã€è®¡åˆ’ä»»åŠ¡ä¿æ´»ã€ç™½+é»‘åŠ è½½å™¨ç­‰

**2. é“¶ç‹ç—…æ¯’ - C2åŸŸåæ£€æµ‹** (Critical)
- ç±»å‹: `dns`
- ç‰¹å¾: `12-18.qq-weixin.org`, `8004.twilight.zip`, `cuomicufvhehy.cn`, `addr.ktsr.cc`, `uiekjxw.net`, `iuearx.net` ç­‰10ä¸ªåŸŸå
- è¯´æ˜: æ£€æµ‹C2å¿ƒè·³ã€é’“é±¼è·³è½¬ã€è¿œæ§å¤‡ç”¨C2ç­‰æ¶æ„åŸŸå

**3. é“¶ç‹ç—…æ¯’ - C2æœåŠ¡å™¨IPæ£€æµ‹** (Critical)
- ç±»å‹: `dst_ip`
- ç‰¹å¾: `183.167.230.197`, `154.94.232.120`, `38.181.42.127`, `192.238.129.9` ç­‰11ä¸ªIP
- è¯´æ˜: æ£€æµ‹è¿æ¥åˆ°C2æœåŠ¡å™¨çš„æµé‡(2025å¹´æ´»è·ƒIP)

**4. é“¶ç‹ç—…æ¯’ - æ¶æ„PNGä¸‹è½½æ£€æµ‹** (Critical)
- ç±»å‹: `http`
- ç‰¹å¾: `183.167.230.197:18743/(0CFA042F|5B16AF14|57BC9B7E|test).Png`
- è¯´æ˜: æ£€æµ‹é€šè¿‡PNGæ–‡ä»¶ä¼ªè£…çš„æ¶æ„è½½è·ä¸‹è½½

**5. é“¶ç‹ç—…æ¯’ - é’“é±¼URLæ£€æµ‹** (Critical)
- ç±»å‹: `http`
- ç‰¹å¾: `baidu.com@cuomicufvhehy.cn`
- è¯´æ˜: æ£€æµ‹ä¼ªè£…æˆç™¾åº¦çš„é’“é±¼URL


#### è§„åˆ™åŒ¹é…é€»è¾‘
```go
// å‘Šè­¦è§„åˆ™åŒ¹é… (internal/store/alert.go)
func matchRule(value string, rule *AlertRule) bool {
    switch rule.ConditionOperator {
    case "regex":
        // æ­£åˆ™åŒ¹é…(æ”¯æŒ(?i)å¿½ç•¥å¤§å°å†™)
        re, _ := regexp.Compile(rule.ConditionValue)
        return re.MatchString(value)
        
    case "contains":
        // é€—å·åˆ†éš”çš„å¤šå€¼åŒ¹é…
        values := strings.Split(rule.ConditionValue, ",")
        for _, v := range values {
            if strings.Contains(value, strings.TrimSpace(v)) {
                return true
            }
        }
        return false
        
    case "equals":
        // ç²¾ç¡®åŒ¹é…
        return value == rule.ConditionValue
    }
}
```

#### å‘Šè­¦æ—¥å¿—å­—æ®µ
| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `id` | å‘Šè­¦ID | 12345 |
| `rule_id` | è§¦å‘çš„è§„åˆ™ID | 3 |
| `rule_name` | è§„åˆ™åç§° | é“¶ç‹ç—…æ¯’ - C2åŸŸåæ£€æµ‹ |
| `alert_level` | å‘Šè­¦çº§åˆ« | critical |
| `trigger_value` | è§¦å‘å€¼ | 12-18.qq-weixin.org |
| `packet_id` | å…³è”æ•°æ®åŒ…ID | 67890 |
| `src_ip` | æºIP | 192.168.1.100 |
| `dst_ip` | ç›®æ ‡IP | 183.167.230.197 |
| `process_name` | å…³è”è¿›ç¨‹ | chrome.exe |
| `count` | èšåˆè®¡æ•° | 15 |
| `first_seen` | é¦–æ¬¡è§¦å‘æ—¶é—´ | 2025-10-08 14:32:15 |
| `last_seen` | æœ€åè§¦å‘æ—¶é—´ | 2025-10-08 14:45:30 |
| `acknowledged` | æ˜¯å¦å·²ç¡®è®¤ | false / true |
| `acknowledged_at` | ç¡®è®¤æ—¶é—´ | 2025-10-08 15:00:00 |

#### è§„åˆ™ç‰ˆæœ¬ç®¡ç†
- âœ… **ç‰ˆæœ¬æ§åˆ¶**: v1.0.0
- âœ… **è‡ªåŠ¨æ›´æ–°**: åªåœ¨ç‰ˆæœ¬å‡çº§æ—¶é‡æ–°å®‰è£…è§„åˆ™
- âœ… **æ™ºèƒ½æ¸…ç†**: è‡ªåŠ¨åˆ é™¤æ—§ç‰ˆæœ¬è§„åˆ™,é¿å…é‡å¤
- âœ… **æ€§èƒ½ä¼˜åŒ–**: é¿å…æ¯æ¬¡å¯åŠ¨éƒ½é‡å¤æ’å…¥è§„åˆ™

#### ä½¿ç”¨åœºæ™¯
-  **APTæ£€æµ‹**: æ£€æµ‹é“¶ç‹ã€Lazarusç­‰APTç»„ç»‡çš„IOC
-  **å®æ—¶å‘Šè­¦**: å‘ç°æ¶æ„æµé‡ç«‹å³å¼¹çª—æé†’
-  **å®‰å…¨æ€åŠ¿**: ç»Ÿè®¡å‘Šè­¦è¶‹åŠ¿,è¯„ä¼°ç½‘ç»œå®‰å…¨çŠ¶å†µ
-  **æº¯æºåˆ†æ**: é€šè¿‡å‘Šè­¦è®°å½•è¿½æº¯æ”»å‡»è·¯å¾„

---

### ğŸ”Ÿ 2Dåœ°å›¾ (2D Map Visualization)

#### åŠŸèƒ½æè¿°
åŸºäºECharts Geoç»„ä»¶çš„ä¸–ç•Œåœ°å›¾æµé‡å¯è§†åŒ–,æ˜¾ç¤ºå…¨çƒè¿æ¥åˆ†å¸ƒã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **åœ°ç†ç¼–ç ** | è‡ªåŠ¨æŸ¥è¯¢IPçš„ç»çº¬åº¦åæ ‡(GeoIP) |
| **çƒ­åŠ›å›¾** | æ ¹æ®è¿æ¥æ•°é‡æ˜¾ç¤ºçƒ­åŠ›åˆ†å¸ƒ |
| **è¿æ¥çº¿** | æ˜¾ç¤ºæºIPåˆ°ç›®æ ‡IPçš„è¿çº¿ |
| **å›½å®¶ç»Ÿè®¡** | ç»Ÿè®¡è¿æ¥æœ€å¤šçš„TOPå›½å®¶ |
| **äº¤äº’å¼æ“ä½œ** | æ”¯æŒç¼©æ”¾ã€å¹³ç§»ã€ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ… |

#### å¯è§†åŒ–æ•ˆæœ
```typescript
// 2Dåœ°å›¾é…ç½® (ECharts Geo)
{
  geo: {
    map: 'world',
    roam: true,  // æ”¯æŒç¼©æ”¾å’Œå¹³ç§»
    itemStyle: {
      areaColor: '#1a1a2e',
      borderColor: '#16213e'
    }
  },
  series: [
    {
      type: 'scatter',      // æ•£ç‚¹å›¾(æ˜¾ç¤ºIPä½ç½®)
      coordinateSystem: 'geo',
      data: [
        { name: '192.168.1.100', value: [116.4, 39.9, 100] }  // [ç»åº¦, çº¬åº¦, è¿æ¥æ•°]
      ]
    },
    {
      type: 'lines',        // è¿çº¿(æ˜¾ç¤ºæµé‡æ–¹å‘)
      data: [
        { coords: [[116.4, 39.9], [-74.0, 40.7]] }  // åŒ—äº¬ â†’ çº½çº¦
      ]
    }
  ]
}
```

#### GeoIPæ•°æ®åº“
- **æ•°æ®æº**: MaxMind GeoLite2 Cityæ•°æ®åº“
- **ç²¾åº¦**: å›½å®¶çº§99%, åŸå¸‚çº§80%
- **æ›´æ–°é¢‘ç‡**: æ¯æœˆæ›´æ–°
- **æ–‡ä»¶è·¯å¾„**: `data/GeoLite2-City.mmdb`

---

### 1ï¸âƒ£1ï¸âƒ£ 3Dåœ°çƒ (3D Globe Visualization)

#### åŠŸèƒ½æè¿°
åŸºäºECharts GLçš„3Dåœ°çƒæµé‡å¯è§†åŒ–,æä¾›æ›´ç‚«é…·çš„å¤§å±å±•ç¤ºæ•ˆæœã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|-------|------|
| **3Dæ¸²æŸ“** | åŸºäºWebGLçš„çœŸå®åœ°çƒæ¸²æŸ“ |
| **æµçº¿æ•ˆæœ** | æ˜¾ç¤ºæ•°æ®æµåŠ¨è½¨è¿¹çš„3Dæµçº¿ |
| **æ•£ç‚¹æ¨¡å¼** | æ˜¾ç¤ºå…¨çƒIPåˆ†å¸ƒçš„3Dæ•£ç‚¹ |
| **æ··åˆæ¨¡å¼** | åŒæ—¶æ˜¾ç¤ºæ•£ç‚¹+æµçº¿ |
| **è‡ªåŠ¨æ—‹è½¬** | åœ°çƒè‡ªåŠ¨æ—‹è½¬å±•ç¤ºå…¨çƒè§†è§’ |
| **è§†è§’åˆ‡æ¢** | æ”¯æŒæ‰‹åŠ¨æ‹–æ‹½è°ƒæ•´è§†è§’ |

#### å¯è§†åŒ–æ¨¡å¼
| æ¨¡å¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|-----|------|---------|
| **æµçº¿æ¨¡å¼** (é»˜è®¤) | æ˜¾ç¤ºæ•°æ®æµåŠ¨è½¨è¿¹çš„å¼§çº¿ | å¤§å±å±•ç¤ºã€åŠ¨æ€æ•ˆæœ |
| **æ•£ç‚¹æ¨¡å¼** | æ˜¾ç¤ºå…¨çƒIPä½ç½®çš„ç‚¹ | åœ°ç†åˆ†å¸ƒåˆ†æ |
| **æ··åˆæ¨¡å¼** | åŒæ—¶æ˜¾ç¤ºæµçº¿+æ•£ç‚¹ | å…¨é¢å±•ç¤º |

#### æŠ€æœ¯å®ç°
```typescript
// 3Dåœ°çƒé…ç½® (ECharts GL)
{
  globe: {
    baseTexture: 'earth.jpg',         // åœ°çƒçº¹ç†
    heightTexture: 'elevation.jpg',   // é«˜åº¦çº¹ç†
    displacementScale: 0.05,          // åœ°å½¢èµ·ä¼
    shading: 'realistic',             // é€¼çœŸå…‰ç…§
    atmosphere: {
      show: true,                     // å¤§æ°”å±‚æ•ˆæœ
    },
    light: {
      ambient: { intensity: 0.4 },    // ç¯å¢ƒå…‰
      main: { intensity: 1.0 }        // ä¸»å…‰æº
    }
  },
  series: [
    {
      type: 'lines3D',                // 3Dæµçº¿
      coordinateSystem: 'globe',
      effect: {
        show: true,
        trailLength: 0.5,             // å°¾è¿¹é•¿åº¦
        trailWidth: 2,                // å°¾è¿¹å®½åº¦
        trailOpacity: 0.8
      }
    }
  ]
}
```

#### æ€§èƒ½ä¼˜åŒ–
- **LOD(Level of Detail)**: æ ¹æ®è·ç¦»è°ƒæ•´æ¸²æŸ“ç²¾åº¦
- **æ•°æ®é‡‡æ ·**: è¿æ¥æ•°è¿‡å¤šæ—¶è‡ªåŠ¨é‡‡æ ·TOP Næ¡
- **å¸§ç‡æ§åˆ¶**: é™åˆ¶æœ€å¤§å¸§ç‡ä¸º60fps
- **GPUåŠ é€Ÿ**: å……åˆ†åˆ©ç”¨WebGLç¡¬ä»¶åŠ é€Ÿ

#### ç”¨æˆ·äº¤äº’
- ğŸ–±ï¸ **é¼ æ ‡æ‹–æ‹½**: æ—‹è½¬åœ°çƒ
- ğŸ” **æ»šè½®ç¼©æ”¾**: æ”¾å¤§/ç¼©å°
- â¸ï¸ **æš‚åœæ—‹è½¬**: é¼ æ ‡æ‚¬åœæ—¶æš‚åœè‡ªåŠ¨æ—‹è½¬
- ğŸ“Š **ç‚¹å‡»æŸ¥çœ‹**: ç‚¹å‡»æµçº¿æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯

---

### 1ï¸âƒ£2ï¸âƒ£ è®¾ç½® (Settings)

#### åŠŸèƒ½æè¿°
ç³»ç»Ÿé…ç½®ç®¡ç†,åŒ…æ‹¬æŠ“åŒ…å‚æ•°ã€å‘Šè­¦è§„åˆ™ã€æ€§èƒ½ä¼˜åŒ–ç­‰è®¾ç½®ã€‚

#### æ ¸å¿ƒåŠŸèƒ½
| æ¨¡å— | è¯´æ˜ |
|-----|------|
| **ç½‘å¡è®¾ç½®** | é€‰æ‹©æŠ“åŒ…ç½‘å¡ã€è®¾ç½®BPFè¿‡æ»¤å™¨ |
| **å­˜å‚¨è®¾ç½®** | è®¾ç½®æ•°æ®åº“è·¯å¾„ã€PCAPä¿å­˜ç­–ç•¥ |
| **æ€§èƒ½è®¾ç½®** | è°ƒæ•´å†…å­˜é™åˆ¶ã€åˆ·æ–°é¢‘ç‡ |
| **å‘Šè­¦è®¾ç½®** | å¯ç”¨/ç¦ç”¨è§„åˆ™ã€è°ƒæ•´å‘Šè­¦çº§åˆ« |
| **GeoIPè®¾ç½®** | é…ç½®GeoIPæ•°æ®åº“è·¯å¾„ |
| **å¯¼å…¥/å¯¼å‡º** | å¯¼å…¥è‡ªå®šä¹‰è§„åˆ™ã€å¯¼å‡ºé…ç½® |

#### é…ç½®æ–‡ä»¶
```yaml
# config.yaml
capture:
  device: "eth0"                     # æŠ“åŒ…ç½‘å¡
  bpf_filter: "tcp or udp"           # BPFè¿‡æ»¤å™¨
  promiscuous: true                  # æ··æ‚æ¨¡å¼
  snaplen: 65535                     # æ•è·é•¿åº¦

storage:
  db_path: "./data/sniffer.db"       # SQLiteæ•°æ®åº“è·¯å¾„
  pcap_dir: "./data/pcap"            # PCAPä¿å­˜ç›®å½•
  pcap_rotation: "1h"                # PCAPè½®è½¬å‘¨æœŸ
  retention_days: 7                  # æ•°æ®ä¿ç•™å¤©æ•°

performance:
  ring_buffer_size: 10000            # ç¯å½¢ç¼“å†²åŒºå¤§å°
  batch_insert_size: 100             # æ‰¹é‡æ’å…¥å¤§å°
  refresh_interval: 2000             # å‰ç«¯åˆ·æ–°é—´éš”(æ¯«ç§’)

alert:
  enabled: true                      # å¯ç”¨å‘Šè­¦
  min_level: "warning"               # æœ€ä½å‘Šè­¦çº§åˆ«
  notification: true                 # æ¡Œé¢é€šçŸ¥

geoip:
  db_path: "./data/GeoLite2-City.mmdb"  # GeoIPæ•°æ®åº“è·¯å¾„
```

#### é«˜çº§è®¾ç½®
- **è°ƒè¯•æ¨¡å¼**: å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡º
- **å¯¼å‡ºæ ¼å¼**: é€‰æ‹©JSON/CSV/PCAPå¯¼å‡ºæ ¼å¼
- **ä¸»é¢˜åˆ‡æ¢**: æ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢
- **è¯­è¨€è®¾ç½®**: ä¸­æ–‡/è‹±æ–‡ç•Œé¢è¯­è¨€

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

**Windows:**
```powershell
# å®‰è£…Npcap (https://npcap.com/)
winget install Npcap.Npcap

# å®‰è£…Go 1.22+
winget install GoLang.Go

# å®‰è£…Node.js 18+
winget install OpenJS.NodeJS
```

**Linux:**
```bash
# å®‰è£…libpcap
sudo apt install libpcap-dev  # Debian/Ubuntu
sudo yum install libpcap-devel  # RedHat/CentOS

# å®‰è£…Go 1.22+
wget https://go.dev/dl/go1.22.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.22.0.linux-amd64.tar.gz

# å®‰è£…Node.js 18+
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs
```

**macOS:**
```bash
# å®‰è£…libpcap (macOSè‡ªå¸¦)
brew install libpcap

# å®‰è£…Goå’ŒNode
brew install go node
```
# macOS ç¼–è¯‘ Sniffer å¸¸è§é—®é¢˜é€ŸæŸ¥è¡¨

| # | ç¼–è¯‘é”™è¯¯ / ç°è±¡ | ä¸€å¥è¯è§£æ³• |
|---|----------------|-------------|
| 1 | `build/appicon.png: no matching files found` | `mkdir -p build && cp xxx.png build/appicon.png`ï¼ˆPNGã€1024Ã—1024ï¼‰ |
| 2 | `vite: Permission denied` | `chmod +x frontend/node_modules/.bin/*` |
| 3 | `Cannot find module @rollup/rollup-darwin-arm64` | `cd frontend && rm -rf node_modules package-lock.json && npm i` |
| 4 | `wailsjs/runtime/package.json: permission denied` | `sudo chown -R $(whoami) frontend/wailsjs frontend/dist` |
| 5 | `image: unknown format / unexpected EOF` | `file build/appicon.png` å¿…é¡»æ˜¯ PNGï¼Œä¸èƒ½æ˜¯ WebP æˆ– 0 KB å ä½æ–‡ä»¶ |
| 6 | ç¼–è¯‘å¡åœ¨ `node_modules` ä¸‹è½½ | `export GOPROXY=https://goproxy.cn ,direct` å†é‡æ–° `wails build` |
| 7 | ç¼–è¯‘é€šè¿‡ä½† `.app` æ‰“ä¸å¼€ï¼ˆé—ªé€€ï¼‰ | `codesign --force --deep --sign - build/bin/sniffer.app && xattr -cr build/bin/sniffer.app` |
| 8 | Apple Silicon æœºå™¨ä¸ŠæŠ¥ `bad CPU type` | ç¡®ä¿æœ¬æœºå·²å®‰è£… Rosetta 2ï¼š`softwareupdate --install-rosetta --agree-to-license` |
| 9 | `wails build` æç¤º `wails: command not found` | å…ˆæŠŠ Go bin ç›®å½•å†™è¿› PATHï¼š<br>`echo 'export PATH="$HOME/go/bin:$PATH"' >> ~/.zshrc && source ~/.zshrc` |
|10| å‰ç«¯ä¾èµ–è£…å®Œä»ç„¶æŠ¥ `rollup` ç›¸å…³é”™ | `npm -g install npm@latest` å‡çº§ npm åé‡æ–° `npm i` |

---



### æ„å»ºè¿è¡Œ

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-repo/fastmonitor.git
cd fastmonitor

# å®‰è£…å‰ç«¯ä¾èµ–
cd frontend && npm install && cd ..

# è¿è¡Œå¼€å‘æ¨¡å¼
wails dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
wails build
```

### é¦–æ¬¡å¯åŠ¨

1. **ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œ** (å¿…éœ€)
   - Windows: å³é”® â†’ "ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"
   - Linux/macOS: `sudo ./fastmonitor`

2. **é€‰æ‹©ç½‘å¡** â†’ ç‚¹å‡»"è®¾ç½®" â†’ é€‰æ‹©æ´»è·ƒç½‘å¡

3. **å¼€å§‹æŠ“åŒ…** â†’ ç‚¹å‡»é¡¶éƒ¨"å¼€å§‹æ•è·"æŒ‰é’®

4. **æŸ¥çœ‹ä»ªè¡¨ç›˜** â†’ å®æ—¶æŸ¥çœ‹æµé‡ç»Ÿè®¡å’Œå›¾è¡¨

---



## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **è¯­è¨€**: Go 1.22
- **æ¡†æ¶**: Wails v2.10
- **æŠ“åŒ…**: gopacket + libpcap
- **æ•°æ®åº“**: SQLite 3
- **GeoIP**: MaxMind GeoLite2

### å‰ç«¯
- **è¯­è¨€**: TypeScript 5.3
- **æ¡†æ¶**: Vue 3.4
- **UIåº“**: Element Plus 2.5
- **çŠ¶æ€ç®¡ç†**: Pinia 2.1
- **è·¯ç”±**: Vue Router 4.2
- **å›¾è¡¨**: ECharts 5.6 + ECharts GL 2.0

---



##  è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Request!

1. Forkæœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»ºPull Request

---


##  è”ç³»æ–¹å¼

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/vam876/FastMonitor
- **é—®é¢˜åé¦ˆ**: https://github.com/vam876/FastMonitor/issues

---

##  è‡´è°¢

- [Wails](https://wails.io/) - è·¨å¹³å°æ¡Œé¢åº”ç”¨æ¡†æ¶
- [gopacket](https://github.com/google/gopacket) - Goæ•°æ®åŒ…å¤„ç†åº“
- [ECharts](https://echarts.apache.org/) - æ•°æ®å¯è§†åŒ–å›¾è¡¨åº“
- [Element Plus](https://element-plus.org/) - Vue 3 UIç»„ä»¶åº“
- [MaxMind](https://www.maxmind.com/) - GeoIPåœ°ç†ä½ç½®æ•°æ®åº“

---

**FastMonitor** - è®©ç½‘ç»œæµé‡ç›‘æ§æ›´ç®€å•ã€æ›´é«˜æ•ˆã€æ›´æ™ºèƒ½! ğŸš€


**å¤‡æ³¨ï¼š** -  wailsæ¡†æ¶ç»ƒæ‰‹é¡¹ç›®ï¼Œå¼€å‘å‘¨æœŸ2å¤©ï¼ŒBUGè¾ƒå¤šï¼Œä»…ä¾›è¯•ç”¨ã€‚
